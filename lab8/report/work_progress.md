Исходный код см. в приложении.